<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    
    <title>Pong</title>
    
    
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    

    <script>
        let ballX = 75;
        let ballY = 75;
        let ballSpdX = 5;
        let ballSpdY = 7;

        const BRICK_W = 100;
        const BRICK_H = 50;
        const BRICK_COUNT = 8;

        let brickGrid = new Array(BRICK_COUNT);

        const PADDLE_WIDTH = 100;
        const PADDLE_HEIGHT = 10;
        const PADDLE_DIST_FROM_EDGE = 60;
        let paddleX = 400;
        let paddleY = 250;

        let canvas, cancasContext;

        let mouseX;
        let mouseY;

        function updateMousePos(event) { //havent gotten 100% but just use for mouse follow event
            let rect = canvas.getBoundingClientRect();
            let root = document.documentElement;
            mouseX = event.clientX - rect.left - root.scrollLeft;
            mouseY = event.clientY - rect.top - root.scrollTop;

            paddleX = mouseX-PADDLE_WIDTH/2;
        }
        function brickReset() {
            for(let i = 0; i<BRICK_COUNT; i++) {
                brickGrid[i] = true;
            }
        }

        window.onload = function() {
            //canvas grabs the canvas on page width and height
            canvas = document.getElementById('gameCanvas');
            //canvasContext is the graphical buffer so that we can draw shapes, fill color etc
            canvasContext = canvas.getContext('2d');
            let framesPerSecond = 30;
            setInterval(updateAll, 1000/framesPerSecond)

            canvas.addEventListener('mousemove', updateMousePos)
            brickReset();
        }
        function updateAll() {
            moveAll();
            drawAll();
        }

        function ballReset() {
            ballX = canvas.width/2;
            ballY = canvas.height/2;
        }

        function moveAll() {
            ballX += ballSpdX;
            ballY += ballSpdY;

            if(ballX > canvas.width-10) { //RIGHT SIDE
                ballSpdX = -ballSpdX;
            }
            if(ballX < 0 + 10) {    //LEFT SIDE
                ballSpdX = -ballSpdX;
            }
            if(ballY > canvas.height-10) { //BOTTOM
                ballReset();
                // ballSpdY = -ballSpdY;
            }
            if(ballY < 0 + 10) { //TOP
                ballSpdY = -ballSpdY;
            }
            let paddleTopEdgeY = canvas.height-PADDLE_DIST_FROM_EDGE;
            let paddleBottomEdgeY = canvas.height-PADDLE_DIST_FROM_EDGE + PADDLE_HEIGHT;
            let paddleLeftEdgeX = paddleX;
            let paddleRightEdgeX = paddleLeftEdgeX + PADDLE_WIDTH;
            if( ballY > paddleTopEdgeY && 
                ballY < paddleBottomEdgeY &&
                ballX > paddleLeftEdgeX && 
                ballX < paddleRightEdgeX) {

                    ballSpdY = -ballSpdY;

                    let centerOfPaddleX = paddleX + PADDLE_WIDTH/2;
                    let ballDistFromPaddleCenterX = ballX - centerOfPaddleX;
                    ballSpdX = ballDistFromPaddleCenterX * 0.35;

                }
        }
        function drawBricks() {
            // if(brickGrid[0]) {
            //     drawRect(0,0,BRICK_W-2,BRICK_H,'blue');
            // }
            // if(brickGrid[1]) {
            //     drawRect(BRICK_W,0,BRICK_W-2,BRICK_H,'blue');
            // }
            // if(brickGrid[2]) {
            //     drawRect(BRICK_W*2,0,BRICK_W-2,BRICK_H,'blue');
            // }
            // if(brickGrid[3]) {
            //     drawRect(BRICK_W*3,0,BRICK_W-2,BRICK_H,'blue');
            // }
            // if(brickGrid[4]) {
            //     drawRect(BRICK_W*4,0,BRICK_W-2,BRICK_H,'blue');
            // }
            for(let i = 0; i<brickGrid.length; i++){
                drawRect(BRICK_W*i,0,BRICK_W-2,BRICK_H,'blue')
            }
            
            
        }

        function drawAll() {
            drawRect(0,0,canvas.width, canvas.height, 'black') //clear canvas each frame by redrawing it FIRST
            drawBall(ballX, ballY, 10, 'white'); //draw ball
            drawRect(paddleX, canvas.height-PADDLE_DIST_FROM_EDGE, PADDLE_WIDTH, PADDLE_HEIGHT, 'white')
            drawBricks();
            colorText(mouseX+","+mouseY, mouseX, mouseY, 'yellow'); //first param the string "," tells JS to stringify the mouseX and mouseY or else they would just be added together
            
        }
        function drawRect(x, y, width, height, color) {
            canvasContext.fillStyle = color;
            canvasContext.fillRect(x, y, width, height)
        }
        function drawBall(x, y, radius, color) {
            canvasContext.fillStyle = color;
            canvasContext.beginPath();
            canvasContext.arc(x, y, radius, 0, Math.PI*2, true);
            canvasContext.fill();
        }
        function colorText(showWords, textX, textY, fillColor) {
            canvasContext.fillStyle = fillColor;
            canvasContext.fillText(showWords, textX, textY);
        }
    </script>
</body>
</html>